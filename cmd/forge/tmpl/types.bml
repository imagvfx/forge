<!doctype html>
<html> [
	<head> [
		{{template "style"}}
	]
	<body> [
		{{template "nav" $}}
		<div class="main"> [
			<div class="one"> [
				<div class="entryTypeList group"> [
					<div class="entryTypeListTitle title"> [
						Entry Types
					]
					<form action="/api/add-entry-type" method="post"> [
						<div> [
							<input name="name" type="text" value="" placeholder="name"> []
							<input readonly name="back_to_referer" type="hidden" value="1"> []
							<button type="submit"> [Add]
						]
					]
					<div style="height:1rem"> []
					{{range $t := $.EntryTypes}}
					<div> [
						<form style="display:inline-block" action="/api/delete-entry-type" method="post"> [
							<input name="name" type="hidden" value="{{$t}}"> []
							<input readonly name="back_to_referer" type="hidden" value="1"> []
							<button style="padding:0;color:red" type="submit"> [-]
						]
						<form style="display:inline-block" action="/api/rename-entry-type" method="post"> [
							<input readonly name="name" type="hidden" value="{{$t}}"> []
							<input name="new_name" type="text" value="{{$t}}"> []
							<input readonly name="back_to_referer" type="hidden" value="1"> []
							<button style="visibility:hidden;" type="submit"> [Rename]
						]
					]
					{{end}}
				]
				{{range $t := $.EntryTypes}}
				<div class="entryType"> [
					<div class="entryTypeName"> [
						{{$t}}
					]
					<div class="subGroup"> [
						<form class="addForm" action="/api/add-default" method="post"> [
							<input readonly name="entry_type" type="hidden" value="{{$t}}"> []
							<select name="category" style="width:6rem;"> [
								<option value="property"> [property]
								<option value="environ"> [environ]
								<option value="access"> [access]
								<option value="sub_entry"> [sub entry]
								{{if not (has $t ".")}}
								<!-- global only has meaning to base types -->
								<option value="global"> [global]
								{{end}}
							]
							<input name="name" type="text" value="" placeholder="name" style="width:10rem;"> []
							<input name="type" type="text" value="" placeholder="type" style="width:8rem;"> []
							<input name="value" type="text" value="" placeholder="value" style="width:32rem;"> []
							<input readonly name="back_to_referer" type="hidden" value="1"> []
							<button type="submit"> [Add]
						]
						<div style="height:0.5rem"> []
						{{$defaults := index $.Defaults $t}}
						{{range $d := $defaults}}
						<div class="modifyForms"> [
							<form class="deleteForm" style="display:inline-block" action="/api/delete-default" method="post"> [
								<input readonly name="entry_type" type="hidden" value="{{$t}}"> []
								<input readonly name="category" type="hidden" value="{{$d.Category}}"> []
								<input readonly name="name" type="hidden" value="{{$d.Name}}"> []
								<input readonly name="back_to_referer" type="hidden" value="1"> []
								<button style="padding:0;color:red" type="submit"> [-]
							]
							<form class="updateForm" style="display:inline-block" action="/api/set-default" method="post"> [
								<input readonly name="entry_type" type="hidden" value="{{$t}}"> []
								<input readonly name="category" type="text" value="{{$d.Category}}" style="border:0;width:6rem;"> []
								<input readonly name="name" type="text" value="{{$d.Name}}" style="width:10rem;"> []
								<input name="type" type="text" value="{{$d.Type}}" style="width:8rem;"> []
								<input name="value" type="text" value="{{$d.Value}}" style="width:32rem;"> []
								<input readonly name="back_to_referer" type="hidden" value="1"> []
								<button type="submit"> [Set]
							]
						]
						{{end}}
						{{$globals := index $.Globals $t}}
						{{range $g := $globals}}
						<div class="modifyForms"> [
							<form class="deleteForm" style="display:inline-block" action="/api/delete-global" method="post"> [
								<input readonly name="entry_type" type="hidden" value="{{$t}}"> []
								<input readonly name="category" type="hidden" value="global"> []
								<input readonly name="name" type="hidden" value="{{$g.Name}}"> []
								<input readonly name="back_to_referer" type="hidden" value="1"> []
								<button style="padding:0;color:red" type="submit"> [-]
							]
							<form class="updateForm" style="display:inline-block" action="/api/set-global" method="post"> [
								<input readonly name="entry_type" type="hidden" value="{{$t}}"> []
								<input readonly name="category" type="text" value="global" style="border:0;width:6rem;"> []
								<input readonly name="name" type="text" value="{{$g.Name}}" style="width:10rem;"> []
								<input name="type" type="text" value="{{$g.Type}}" style="width:8rem;"> []
								<input name="value" type="text" value="{{$g.Value}}" style="width:32rem;"> []
								<input readonly name="back_to_referer" type="hidden" value="1"> []
								<button type="submit"> [Set]
							]
						]
						{{end}}
					]
				]
				{{end}}
			]
		]
	]
]

<style> [`
.entryType {
	margin-bottom: 2rem;
}

.entryTypeName {
	font-weight: bold;
	font-size: 1.1rem;
	margin-bottom: 1rem;
}

.group {
	margin-bottom: 2rem;
}

.subGroup {
	margin-left: 1.5rem;
	margin-bottom: 0.5rem;
}

.title {
	font-size: 1.6rem;
	margin-bottom: 1rem;
}

.subTitle {
	font-size: 0.9rem;
	margin-bottom: 0.5rem;
}

.addForm {
	margin-bottom: 0.4rem;
}

.modifyForms {
	margin-bottom: 0.3rem;
}

.updateForm {
	border: 1px solid #888888;
	border-radius: 3px;
	padding: 0;
}

.updateForm input {
	margin: 0;
	padding: 0 0.3rem;
	border: 0;
	border-left: 1px solid #CCCCCC;
}

.updateForm button {
	visibility: hidden;
	width: 0;
	margin: 0;
	padding: 0;
}
`]

<script> [`
"use strict";

window.onload = function() {
	let addForms = document.getElementsByClassName("addForm");
	for (let form of addForms) {
		form.onsubmit = function() {
			let formData = new FormData(form);
			if (formData.get("category") == "global") {
				form.action = "/api/add-global";
			}
		}
	}
}
`]
